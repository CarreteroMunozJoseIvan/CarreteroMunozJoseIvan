from pathlib import Path
import os

# 1Ô∏è‚É£ Define your base directory (current_path works fine)
base_dir = Path(r"C:\Users\imunoz011\OneDrive - Everest Reinsurance\Documents\Aon GPF Automation")

# 2Ô∏è‚É£ Move into the "Final_Slips" folder
final_slips_dir = base_dir / "Final_Slips"

# Check that it exists
if not final_slips_dir.exists():
    raise FileNotFoundError(f"‚ùå Folder not found: {final_slips_dir}")

print(f"üìÅ Scanning base folder: {final_slips_dir}")

# 3Ô∏è‚É£ Loop through every subfolder (each slip folder)
for slip_folder in sorted(final_slips_dir.iterdir()):
    if slip_folder.is_dir():
        print(f"\nüîπ Folder: {slip_folder.name}")

        # 4Ô∏è‚É£ Get all PDFs inside this folder and any subfolders
        pdf_files = list(slip_folder.rglob("*.pdf"))  # rglob = recursive
        if not pdf_files:
            print("   ‚ö†Ô∏è No PDFs found here")
            continue

        for pdf_path in pdf_files:
            full_path = pdf_path.resolve()  # ‚úÖ full absolute path
            print(f"   ‚Üí Found PDF: {full_path.name}")
            print(f"     Full path: {full_path}")

            # 5Ô∏è‚É£ Now pass it to your text extractor
            text = extract_text_pdf_robust(full_path)

            # Optional: preview how much text was extracted
            print(f"     Extracted {len(text)} characters\n")
