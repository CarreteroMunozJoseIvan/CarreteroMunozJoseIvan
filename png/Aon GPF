df_archivos.groupby("CarpetaCuenta").size().reset_index(name="TotalArchivos")

resumen_ext = (
    df_archivos
    .groupby(["CarpetaCuenta", "Extension"])
    .size()
    .unstack(fill_value=0)
    .reset_index()
)

resumen_ext

orden_columnas = [".pdf", ".xlsx", ".xls", ".xlsm", ".csv"]

for col in orden_columnas:
    if col not in resumen_ext.columns:
        resumen_ext[col] = 0

resumen_ext = resumen_ext[["CarpetaCuenta"] + orden_columnas]

import pandas as pd

def resumen_con_archivos(df):
    resumen = []

    for carpeta, grupo in df.groupby("CarpetaCuenta"):
        # agrupar dentro de la carpeta por extensi칩n
        ext_map = {}
        for ext, subgrupo in grupo.groupby("Extension"):
            # lista de archivos
            lista_archivos = subgrupo["NombreArchivo"].tolist()
            ext_map[ext] = lista_archivos

        # construir la fila final para esa carpeta
        fila = {"CarpetaCuenta": carpeta}

        # a침adir din치micamente cada tipo de extensi칩n
        for ext, archivos in ext_map.items():
            fila[f"{ext}_files"] = archivos
            fila[f"{ext}_count"] = len(archivos)

        resumen.append(fila)

    # convertir a DF
    df_res = pd.DataFrame(resumen).fillna(0)
    return df_res


# === USO ===
df_resumen_archivos = resumen_con_archivos(df_archivos)
df_resumen_archivos

orden = ["CarpetaCuenta", ".pdf_files", ".pdf_count", ".xlsx_files", ".xlsx_count", ".xls_files", ".xls_count", ".csv_files", ".csv_count"]

for col in orden:
    if col not in df_resumen_archivos.columns:
        df_resumen_archivos[col] = 0

df_resumen_archivos = df_resumen_archivos[orden]
