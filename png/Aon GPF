def extract_name_and_layer(text: str):
    lines = [l.strip() for l in text.splitlines() if l.strip()]

    # === CASO 1: tu primera estructura "Nombre - layer" ===
    for line in lines:
        if "Aon GPF" in line:
            continue  # lo manejamos en el caso 2
        if " - " in line:
            parts = [p.strip() for p in line.split(" - ") if p.strip()]
            if len(parts) >= 2:
                name = parts[0]
                layer = parts[-1]
                return name, layer

    # === CASO 2: correos Aon GPF (los dos ejemplos nuevos) ===
    for line in lines:
        if "Aon GPF" in line:
            parts = [p.strip(" -\u2013") for p in line.split("-") if p.strip(" -\u2013")]
            if len(parts) < 3:
                break

            name = parts[1]  # segundo bloque

            pol_idx = None
            for i, p in enumerate(parts):
                if re.search(r"\bPT[A-Z0-9]+", p):
                    pol_idx = i
                    break

            layer = None
            if pol_idx is not None:
                for p in parts[pol_idx + 1:]:
                    if re.search(r"\b(xs?|x)\b", p, re.IGNORECASE):
                        layer = p
                        break
                if layer is None and len(parts) > pol_idx + 1:
                    layer = parts[-1]

            return name.strip(), layer.strip() if layer else None

    return None, None
